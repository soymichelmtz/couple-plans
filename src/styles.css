/* Couple Plans - Mobile-first "web app" look */

/* Light theme (default) */
:root {
  --bg: #fff7fb;
  --bg2: #fff1f7;
  --card: rgba(255, 255, 255, 0.80);
  --card2: rgba(255, 255, 255, 0.65);
  --text: rgba(17, 24, 39, 0.93);
  --muted: rgba(17, 24, 39, 0.72);
  --muted2: rgba(17, 24, 39, 0.55);
  --border: rgba(17, 24, 39, 0.12);

  /* Love / couple palette */
  --primary: #fb7185;   /* rose */
  --primary2: #a78bfa;  /* lavender */
  --accent: #22c55e;    /* for "completed" */
  --danger: #ef4444;
  --warning: #f59e0b;

  --shadow: 0 18px 50px rgba(17, 24, 39, 0.14);
  --radius: 16px;
  --radius-sm: 12px;
  --focus: 0 0 0 3px rgba(251, 113, 133, 0.24);
}

/* Dark theme */
html[data-theme="dark"] {
  --bg: #0b1220;
  --bg2: #09101c;
  --card: rgba(255, 255, 255, 0.08);
  --card2: rgba(255, 255, 255, 0.05);
  --text: rgba(255, 255, 255, 0.92);
  --muted: rgba(255, 255, 255, 0.72);
  --muted2: rgba(255, 255, 255, 0.55);
  --border: rgba(255, 255, 255, 0.14);

  --primary: #fb7185;
  --primary2: #a78bfa;
  --accent: #22c55e;
  --danger: #f87171;
  --warning: #fb923c;

  --shadow: 0 18px 50px rgba(0, 0, 0, 0.45);
  --focus: 0 0 0 3px rgba(251, 113, 133, 0.28);
}

* { box-sizing: border-box; }

html, body {
  height: 100%;
  margin: 0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica,
    Arial, "Apple Color Emoji", "Segoe UI Emoji";
  background:
    radial-gradient(1200px 900px at 18% 10%, rgba(251, 113, 133, 0.20), transparent 60%),
    radial-gradient(1000px 700px at 92% 30%, rgba(167, 139, 250, 0.16), transparent 55%),
    radial-gradient(1000px 700px at 50% 100%, rgba(34, 197, 94, 0.10), transparent 55%),
    linear-gradient(180deg, var(--bg), var(--bg2));
  color: var(--text);
}

/* Keep vertical scrollbar layout stable to avoid horizontal shifts when content
   changes (prevents card/container width jumping when the page gets taller).
   `scrollbar-gutter` is modern; `overflow-y: scroll` ensures a scrollbar on
   Windows so width stays consistent. */
html { scrollbar-gutter: stable; }
body { overflow-y: scroll; }

a { color: inherit; }

.app {
  min-height: 100%;
  display: grid;
  grid-template-rows: auto 1fr auto;
}

.topbar {
  position: sticky;
  top: 0;
  z-index: 20;
  backdrop-filter: blur(12px);
  background: color-mix(in srgb, var(--bg) 70%, transparent);
  border-bottom: 1px solid var(--border);
}

.topbar-inner {
  max-width: 980px;
  margin: 0 auto;
  padding: 10px 14px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}


.brand-logo {
  width: 34px;
  height: 34px;
  display: grid;
  place-items: center;
  border-radius: 12px;
  background: linear-gradient(135deg, color-mix(in srgb, var(--primary) 20%, transparent), color-mix(in srgb, var(--primary2) 18%, transparent));
  border: 1px solid var(--border);
}

.brand-title {
  display: flex;
  flex-direction: column;
  line-height: 1.1;
}

.brand-title strong { font-size: 14px; letter-spacing: 0.2px; }
.brand-title span { font-size: 12px; color: var(--muted2); }

.container {
  max-width: 980px;
  margin: 0 auto;
  padding: 14px;
  padding: 8px 10px;
}

.card {
  background: linear-gradient(180deg, var(--card), var(--card2));
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  /* Prevent the card from growing wider than its container when inner
     content (like the compact grid) temporarily causes overflow. Keep the
     card sizing stable to avoid layout shifts when toggling views. */
  width: 100%;
  max-width: 100%;
  overflow-x: hidden;
}

.card-inner { padding: 14px; }

.grid {
  display: grid;
  gap: 12px;
}

@media (min-width: 860px) {
  .grid.two {
    grid-template-columns: 1fr 1fr;
    align-items: start;
  }
}

.btn {
  appearance: none;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.08);
  color: var(--text);
  border-radius: 14px;
  padding: 10px 12px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-weight: 650;
  letter-spacing: 0.2px;
}

.btn:hover { background: rgba(255,255,255,0.11); }
.btn:active { transform: translateY(1px); }
.btn:focus-visible { outline: none; box-shadow: var(--focus); }

.btn.primary {
  background: linear-gradient(135deg, color-mix(in srgb, var(--primary) 88%, white 12%), color-mix(in srgb, var(--primary2) 78%, white 22%));
  border-color: color-mix(in srgb, var(--primary) 30%, transparent);
}

.btn.primary:hover { filter: brightness(1.03); }

.btn.success {
  background: linear-gradient(135deg, color-mix(in srgb, var(--accent) 88%, white 12%), rgba(16, 185, 129, 0.75));
  border-color: color-mix(in srgb, var(--accent) 30%, transparent);
}

.btn.danger {
  background: rgba(248, 113, 113, 0.15);
  border-color: rgba(248, 113, 113, 0.25);
}

.btn.ghost {
  background: transparent;
}

.btn.small { padding: 8px 10px; border-radius: 12px; font-weight: 650; }

.row {
  display: flex;
  gap: 10px;
  align-items: center;
  flex-wrap: wrap;
}

.row.nowrap {
  flex-wrap: nowrap;
}

.row.space { justify-content: space-between; flex-wrap: nowrap; align-items: center; }

.view-toggle {
  display: inline-flex;
  gap: 4px;
  padding: 2px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: color-mix(in srgb, var(--card) 88%, transparent);
}

/* Keep the view-toggle on the same line when inside a wrapping row */
.row.space > .view-toggle {
  flex: 0 0 auto;
  margin-left: auto; /* push to the right */
}

/* Utility to right-align contents of a row */
.row.right { justify-content: flex-end; }

/* Allow the left-side content in the spaced row to shrink so the toggle can stay on one line */
.row.space > .row:first-child {
  /* Reduce how much the left-side block expands inside spaced rows so
     the right-side counter/toggle doesn't get pushed all the way to the edge. */
  flex: 0.6 1 auto;
  min-width: 0;
  /* give a little breathing room between the left pills and the view-toggle */
  margin-right: 12px;
}

.view-toggle__btn {
  appearance: none;
  border: 1px solid transparent;
  background: transparent;
  color: var(--muted);
  border-radius: 999px;
  width: 34px;
  height: 30px;
  cursor: pointer;
  font-size: 14px;
  display: grid;
  place-items: center;
}

.view-toggle__btn.active {
  color: var(--text);
  background: rgba(17, 24, 39, 0.10);
  border-color: rgba(17, 24, 39, 0.18);
}

html[data-theme="dark"] .view-toggle__btn.active {
  background: rgba(255, 255, 255, 0.10);
  border-color: rgba(255, 255, 255, 0.18);
}

.plan-grid {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 10px;
  width: 100%;
}

/* Allow any grid item to shrink so 2 columns actually fit (esp. in DevTools mobile emulation) */
.plan-grid > * {
  min-width: 0;
}

@media (min-width: 860px) {
  .plan-grid {
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }
}

/* Compact view uses the same `details.plan` card look, but laid out in a grid */
.plan-grid .plan {
  margin: 0;
  padding: 10px;
  box-shadow: 0 10px 24px rgba(0,0,0,0.06);
  min-width: 0; /* allow 2-column shrink instead of forcing 1 column */
}

/* Ensure the first compact/grid card has a top gap similar to list view */
.plan-grid .plan:first-child {
  margin-top: 10px;
}

.plan-grid .plan-summary {
  cursor: pointer;
}

.plan-grid .plan-summary-left {
  min-width: 0;
}


.plan-grid .plan-summary-left h3 {
  font-size: 13px;
  line-height: 1.15;
  margin: 0;
  white-space: normal;
  overflow-wrap: break-word;
  word-break: break-word;
}

.plan-grid .plan-summary-left .small {
  white-space: normal;
  overflow-wrap: break-word;
  word-break: break-word;
}

/* Hide list-only parts in compact grid */
.plan-grid .drag-handle,
.plan-grid .plan-summary-right,
.plan-grid .meta,
.plan-grid .plan-actions {
  display: none !important;
}

.tagbar {
  display: flex;
  align-items: center;
  gap: 0px;
  flex-wrap: nowrap;
  overflow-x: auto;
  padding: 8px 2px;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
}

.tagbar::-webkit-scrollbar { display: none; }

.tag {
  appearance: none;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.06);
  color: var(--text);
  border-radius: 999px;
  padding: 8px 6px;
  min-width: 40px;
  height: 38px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  cursor: pointer;
  flex: 0 0 auto;
}

.tag:focus-visible { outline: none; box-shadow: var(--focus); }

.tag.active {
  background: color-mix(in srgb, var(--primary) 18%, rgba(255,255,255,0.06));
  border-color: color-mix(in srgb, var(--primary) 45%, rgba(255,255,255,0.14));
}

.tag.clear {
  font-size: 14px;
  padding: 8px 10px;
  color: var(--muted);
}

.tag-sep {
  color: var(--muted2);
  padding: 0 2px;
  user-select: none;
}

.input, select, textarea {
  width: 100%;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.06);
  color: var(--text);
  outline: none;
}

.input:focus, select:focus, textarea:focus { box-shadow: var(--focus); border-color: rgba(167, 139, 250, 0.35); }

label {
  display: block;
  font-size: 12px;
  color: var(--muted);
  margin-bottom: 6px;
}

.form-grid {
  display: grid;
  gap: 12px;
}

@media (min-width: 540px) {
  .form-grid.two {
    grid-template-columns: 1fr 1fr;
  }
}

.help {
  font-size: 12px;
  color: var(--muted2);
  margin-top: 6px;
}

.pill {
  display: inline-flex;
  gap: 8px;
  align-items: center;
  border-radius: 999px;
  padding: 6px 10px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  color: var(--muted);
  font-size: 12px;
}
.meta {
  color: #000;
}

/* .plan-actions early absolute positioning removed to avoid overlap with comment text; handled later when expanded */

.icon-action {
  font-size: 16px;
}

.icon-action.danger {
  color: var(--danger);
}


/* Accordion plan cards */
.plan {
  border: 1px solid var(--border);
  border-radius: 14px;
  background: var(--card);
  padding: 12px;
  position: relative;
}

/* Status indicator as left border */
.plan.is-pending {
  border-left: 8px solid color-mix(in srgb, #ff3b30 75%, white);
}

.plan.is-done {
  border-left: 8px solid color-mix(in srgb, #34c759 75%, white);
}

.plan + .plan { margin-top: 10px; }

.plan summary { list-style: none; cursor: pointer; }
.plan summary::-webkit-details-marker { display: none; }

.plan-summary {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.plan-summary-left {
  display: flex;
  align-items: center;
  gap: 10px;
  min-width: 0;
}

.plan-summary-right {
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.meta--singleline {
  flex-wrap: nowrap;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.drag-handle {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 44px;
  height: 44px;
  border-radius: 10px;
  border: 1px solid var(--border);
  color: var(--muted);
  user-select: none;
  touch-action: none;
}

.icon-btn {
  border: none;
  background: color-mix(in srgb, var(--card) 85%, transparent);
  color: var(--text);
  border-radius: 10px;
  width: 34px;
  height: 34px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

.icon-btn.fav {
  color: #d4af37; /* gold */
}

.icon-btn:hover {
  filter: brightness(1.02);
}

.icon-btn:active {
  transform: translateY(1px);
}

.plan .icon-btn {
  font-size: 24px;
  line-height: 1;
}

/* While dragging (mobile), prevent the browser from turning the gesture into scroll */
.drag-mode {
  touch-action: none;
}



.meta-break {
  flex-basis: 100%;
  height: 0;
}

.plan-actions {
  /* Keep actions visually aligned to the right corner of the card */
  position: absolute;
  right: 10px;
  bottom: 10px;
  display: inline-flex;
  gap: 10px;
  justify-content: flex-end;
  align-items: center;
  margin-top: 0;
}

/* Separator above actions (only visible when expanded) */
.plan[open] .plan-actions {
  margin-top: 10px;
  padding-top: 10px;
}

/* Comment text inside plan cards: justified and avoid overlapping action buttons */
.plan-comment {
  text-align: justify;
  /* reserve horizontal space to prevent overlap with the absolute-positioned actions */
  margin-right: 125px;
}

/* Show edit/delete only when the card is expanded */
.plan:not([open]) .plan-actions {
  display: none;
}

.icon-action {
  border: none;
  background: transparent;
  cursor: pointer;
  font-size: 16px;
  line-height: 1;
  padding: 6px;
  border-radius: 10px;
}

.icon-action:hover {
  background: color-mix(in srgb, var(--card) 70%, transparent);
}

.icon-action:active {
  transform: translateY(1px);
}

/* Map action button (distinctive color) */
.icon-action.map {
  color: #1E8FCD; /* custom blue */
}
.icon-action.map:hover {
  background: color-mix(in srgb, #1E8FCD 12%, var(--card));
  border-color: color-mix(in srgb, #1E8FCD 18%, transparent);
}

/* Modal */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.45);
  backdrop-filter: blur(2px);
  display: grid;
  place-items: center;
  z-index: 999;
  padding: 18px;
}

.modal {
  width: min(460px, 100%);
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 14px;
  box-shadow: 0 18px 60px rgba(0,0,0,.25);
  display: grid;
  gap: 10px;
}

.modal-title {
  font-weight: 900;
  font-size: 16px;
}

.modal-text {
  color: var(--muted2);
  font-size: 13px;
}

.row.end {
  justify-content: flex-end;
}

.plan[open] { box-shadow: 0 10px 30px rgba(0,0,0,.08); }

.plan.dragging {
  opacity: 0.85;
  outline: 2px dashed color-mix(in srgb, var(--accent) 55%, transparent);
  outline-offset: 4px;
}

.plan.drag-over {
  box-shadow: 0 0 0 2px color-mix(in srgb, var(--accent) 45%, transparent);
}
.tabs {
  display: inline-flex;
  gap: 8px;
  padding: 6px;
  border-radius: 14px;
  border: 1px solid color-mix(in srgb, var(--border) 70%, transparent);
  background: linear-gradient(180deg,
    color-mix(in srgb, var(--card) 88%, transparent),
    color-mix(in srgb, var(--card) 76%, transparent)
  );
}

.tab {
  border: 1px solid transparent;
  background: transparent;
  color: var(--muted);
  padding: 10px 12px;
  border-radius: 12px;
  cursor: pointer;
  font-weight: 900;
  letter-spacing: 0.1px;
}

.tab.active {
  background: rgba(17, 24, 39, 0.10);
  border-color: rgba(17, 24, 39, 0.18);
  color: rgba(17, 24, 39, 0.95);
}

html[data-theme="dark"] .tab.active {
  background: rgba(255, 255, 255, 0.10);
  border-color: rgba(255, 255, 255, 0.18);
  color: rgba(255, 255, 255, 0.92);
}

.pill-btn {
  appearance: none;
  border-radius: 999px;
  padding: 8px 8px;
  font-size: 11px;
  cursor: pointer;
  border: 1px solid var(--border);
  background: rgba(255,255,255,0.06);
  color: var(--muted);
  font-weight: 750;
}

.pill-btn.active {
  color: var(--text);
}

/* Status-colored active background for quick filter */
.pill-btn.pending.active {
  background: color-mix(in srgb, #ff3b30 18%, var(--card));
  border-color: color-mix(in srgb, #ff3b30 38%, transparent);
}

.pill-btn.done.active {
  background: color-mix(in srgb, #34c759 18%, var(--card));
  border-color: color-mix(in srgb, #34c759 38%, transparent);
}

.pill.ok { border-color: rgba(34,197,94,0.25); color: rgba(255,255,255,0.86); background: rgba(34,197,94,0.10); }

html:not([data-theme="dark"]) .pill.ok {
  color: rgba(17, 24, 39, 0.88);
  border-color: color-mix(in srgb, var(--accent) 35%, transparent);
  background: color-mix(in srgb, var(--accent) 14%, transparent);
}
.pill.warn { border-color: rgba(251,146,60,0.25); background: rgba(251,146,60,0.10); }

/* Explicit 'No' state for "Ir otra vez: No" -> red styling */
.pill.no {
  border-color: rgba(239,68,68,0.25);
  color: rgba(255,255,255,0.92);
  background: rgba(239,68,68,0.08);
}

html:not([data-theme="dark"]) .pill.no {
  color: rgba(17, 24, 39, 0.88);
  border-color: color-mix(in srgb, var(--danger) 35%, transparent);
  background: color-mix(in srgb, var(--danger) 14%, transparent);
}

.list {
  display: grid;
  gap: 10px;
}

.plan {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: var(--radius-sm);
  padding: 12px;
  display: grid;
  gap: 10px;
}

.plan-top {
  display: flex;
  gap: 10px;
  align-items: flex-start;
  justify-content: space-between;
}

.plan h3 {
  margin: 0;
  font-size: 15px;
  letter-spacing: 0.2px;
}

.meta {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-top: 8px;
}

.small {
  font-size: 12px;
  color: var(--muted2);
}

/* Prevent the small counter (e.g. "13 de 14") from forcing wraps in
   compact/mobile rows. Keep it compact and prevent it from growing. */
.row.space > .small {
  flex: 0 0 auto;       /* don't grow or shrink */
  font-size: 10px;      /* slightly smaller to fit better on small screens */
  color: var(--muted2);
  white-space: nowrap;  /* avoid wrapping the text */
  margin: 0 4px;        /* reduce left/right gap around the counter */
  padding: 0;           /* remove any extra internal spacing */
  line-height: 1;       /* slightly tighter line height */
}

.footer {
  max-width: 980px;
  margin: 0 auto;
  padding: 14px;
  width: 100%;
  color: var(--muted2);
  font-size: 12px;
}

.stars {
  display: inline-flex;
  gap: 4px;
  align-items: center;
}

.star {
  width: 28px;
  height: 28px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.06);
  cursor: pointer;
  display: grid;
  place-items: center;
  user-select: none;
}

.star[aria-pressed="true"] {
  background: rgba(167, 139, 250, 0.25);
  border-color: rgba(167, 139, 250, 0.35);
}

.star:focus-visible { outline: none; box-shadow: var(--focus); }

.hr {
  height: 1px;
  background: rgba(255,255,255,0.12);
  margin: 12px 0;
}

.badge {
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  border-radius: 999px;
  font-size: 12px;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.05);
}

.badge.pending { border-color: rgba(251,146,60,0.25); background: rgba(251,146,60,0.10); }
.badge.done { border-color: rgba(34,197,94,0.25); background: rgba(34,197,94,0.10); }

/* Theme toggle (replaces Export/Import) */
.theme-toggle {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  border: 1px solid var(--border);
  background: color-mix(in srgb, var(--card) 88%, transparent);
  color: var(--text);
  border-radius: 999px;
  padding: 8px 10px;
  cursor: pointer;
  user-select: none;
}

.theme-toggle:active {
  transform: translateY(1px);
}

.theme-toggle__emoji {
  font-size: 16px;
  line-height: 1;
}

.theme-toggle__text {
  font-size: 13px;
  color: var(--muted);
}

.theme-toggle__switch {
  width: 44px;
  height: 24px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.08);
  position: relative;
  flex: 0 0 auto;
}

.theme-toggle__knob {
  position: absolute;
  top: 50%;
  left: 3px;
  width: 18px;
  height: 18px;
  border-radius: 999px;
  transform: translateY(-50%);
  background: rgba(255,255,255,0.9);
  box-shadow: 0 2px 10px rgba(0,0,0,0.25);
  transition: transform 160ms ease;
}

.theme-toggle__switch.is-on {
  background: rgba(167, 139, 250, 0.22);
  border-color: rgba(167, 139, 250, 0.35);
}

.theme-toggle__switch.is-on .theme-toggle__knob {
  transform: translateY(-50%) translateX(20px);
}

.toast {
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  bottom: 18px;
  /* Always high-contrast text (toast bg is dark/ink) */
  color: #fff;
  background: rgba(17, 24, 39, 0.95);
  border: 1px solid rgba(255,255,255,0.18);
  border-radius: 999px;
  padding: 10px 12px;
  box-shadow: var(--shadow);
  opacity: 0;
  pointer-events: none;
  transition: opacity 180ms ease, transform 180ms ease;
}

/* Slightly different ink in dark mode so it doesn't blend into the page */
html[data-theme="dark"] .toast {
  background: rgba(0, 0, 0, 0.78);
  border-color: rgba(255,255,255,0.22);
}

.toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(-4px);
}
